{
  "version": "1.0",
  "updated_at": "2024-01-15T10:00:00Z",
  "services": {
    "postgres": {
      "image": "postgres:15-alpine",
      "restart": "always",
      "env": {
        "POSTGRES_USER": "hostfy",
        "POSTGRES_PASSWORD": "{{SYSTEM_GENERATE}}",
        "POSTGRES_DB": "hostfy"
      },
      "volumes": [
        "hostfy_postgres_data:/var/lib/postgresql/data"
      ],
      "ports": [
        "5432:5432"
      ],
      "healthcheck": {
        "test": [
          "CMD-SHELL",
          "pg_isready -U hostfy"
        ],
        "interval": "10s",
        "retries": 5
      }
    },
    "redis": {
      "image": "redis:7-alpine",
      "restart": "always",
      "command": "redis-server --appendonly yes",
      "volumes": [
        "hostfy_redis_data:/data"
      ],
      "ports": [
        "6379:6379"
      ],
      "healthcheck": {
        "test": [
          "CMD",
          "redis-cli",
          "ping"
        ],
        "interval": "10s",
        "retries": 5
      }
    }
  },
  "apps": {
    "n8n": {
      "name": "n8n",
      "description": "Workflow Automation Tool - Stack com Editor + Webhook + Worker para alta disponibilidade",
      "dependencies": [
        "postgres",
        "redis"
      ],
      "shared_env": {
        "DB_TYPE": "postgresdb",
        "DB_POSTGRESDB_HOST": "{{SERVICE_postgres_HOST}}",
        "DB_POSTGRESDB_PORT": "5432",
        "DB_POSTGRESDB_DATABASE": "{{APP_DATABASE}}",
        "DB_POSTGRESDB_USER": "{{SERVICE_postgres_USER}}",
        "DB_POSTGRESDB_PASSWORD": "{{SERVICE_postgres_PASSWORD}}",
        "QUEUE_BULL_REDIS_HOST": "{{SERVICE_redis_HOST}}",
        "QUEUE_HEALTH_CHECK_ACTIVE": "true",
        "EXECUTIONS_MODE": "queue",
        "N8N_ENCRYPTION_KEY": "{{GENERATE_SECRET_32}}",
        "N8N_PROTOCOL": "https",
        "N8N_TRUST_PROXY": "true",
        "N8N_PROXY_HOPS": "2",
        "GENERIC_TIMEZONE": "America/Sao_Paulo",
        "N8N_WEBHOOK_DOMAIN": "{{APP_DOMAIN}}",
        "N8N_CONCURRENCY_PRODUCTION_LIMIT": "20",
        "N8N_RUNNERS_ENABLED": "true"
      },
      "containers": [
        {
          "name": "editor",
          "image": "n8nio/n8n:latest",
          "port": 5678,
          "is_main": true,
          "env": {
            "N8N_HOST": "{{APP_DOMAIN}}",
            "N8N_EDITOR_BASE_URL": "https://{{APP_DOMAIN}}",
            "WEBHOOK_URL": "https://{{N8N_WEBHOOK_DOMAIN}}"
          },
          "volumes": [
            "{{APP_NAME}}_data:/home/node/.n8n"
          ]
        },
        {
          "name": "webhook",
          "image": "n8nio/n8n:latest",
          "port": 5678,
          "command": "webhook",
          "env": {
            "N8N_DISABLE_UI": "true",
            "WEBHOOK_URL": "https://{{N8N_WEBHOOK_DOMAIN}}",
            "BASE_URL": "https://{{N8N_WEBHOOK_DOMAIN}}"
          },
          "volumes": [
            "{{APP_NAME}}_data:/home/node/.n8n"
          ],
          "traefik": {
            "routes": [
              {
                "subdomain": "{{N8N_WEBHOOK_DOMAIN}}",
                "port": 5678
              }
            ]
          }
        },
        {
          "name": "worker",
          "image": "n8nio/n8n:latest",
          "command": "worker --concurrency=10",
          "env": {
            "N8N_DISABLE_UI": "true"
          },
          "volumes": [
            "{{APP_NAME}}_data:/home/node/.n8n"
          ]
        }
      ],
      "user_env": []
    },
    "chatwoot": {
      "name": "Chatwoot",
      "description": "Customer Engagement Platform - Atendimento ao cliente omnichannel",
      "dependencies": [
        "redis"
      ],
      "shared_env": {
        "RAILS_ENV": "production",
        "NODE_ENV": "production",
        "INSTALLATION_ENV": "docker",
        "SECRET_KEY_BASE": "{{GENERATE_SECRET_64}}",
        "FRONTEND_URL": "https://{{APP_DOMAIN}}",
        "POSTGRES_HOST": "{{APP_NAME}}-postgres",
        "POSTGRES_PORT": "5432",
        "POSTGRES_DATABASE": "chatwoot",
        "POSTGRES_USERNAME": "chatwoot",
        "POSTGRES_PASSWORD": "{{GENERATE_SECRET_32}}",
        "REDIS_URL": "redis://{{SERVICE_redis_HOST}}:6379",
        "RAILS_LOG_TO_STDOUT": "true",
        "DEFAULT_LOCALE": "pt_BR",
        "ENABLE_ACCOUNT_SIGNUP": "false"
      },
      "containers": [
        {
          "name": "postgres",
          "image": "pgvector/pgvector:pg16",
          "env": {
            "POSTGRES_USER": "chatwoot",
            "POSTGRES_PASSWORD": "{{POSTGRES_PASSWORD}}",
            "POSTGRES_DB": "chatwoot"
          },
          "volumes": [
            "{{APP_NAME}}_postgres_data:/var/lib/postgresql/data"
          ]
        },
        {
          "name": "rails",
          "image": "chatwoot/chatwoot:latest",
          "port": 3000,
          "is_main": true,
          "command": "sh -c 'bundle exec rails db:chatwoot_prepare && bundle exec rails s -p 3000 -b 0.0.0.0'",
          "env": {},
          "volumes": [
            "{{APP_NAME}}_storage:/app/storage"
          ]
        },
        {
          "name": "sidekiq",
          "image": "chatwoot/chatwoot:latest",
          "command": "bundle exec sidekiq -C config/sidekiq.yml",
          "env": {},
          "volumes": [
            "{{APP_NAME}}_storage:/app/storage"
          ]
        }
      ],
      "user_env": [
        {
          "key": "MAILER_SENDER_EMAIL",
          "prompt": "Email do remetente (para notificações)",
          "default": "noreply@{{APP_DOMAIN}}"
        }
      ]
    },
    "evolution-api": {
      "name": "Evolution API",
      "description": "WhatsApp API - Integração WhatsApp para automações e chatbots",
      "image": "evoapicloud/evolution-api:latest",
      "port": 8080,
      "dependencies": [
        "postgres",
        "redis"
      ],
      "env": {
        "SERVER_URL": "https://{{APP_DOMAIN}}",
        "SERVER_TYPE": "http",
        "SERVER_PORT": "8080",
        "CORS_ORIGIN": "*",
        "CORS_METHODS": "GET,POST,PUT,DELETE",
        "CORS_CREDENTIALS": "true",
        "LOG_LEVEL": "ERROR,WARN,DEBUG,INFO,LOG,VERBOSE,DARK,WEBHOOKS",
        "DEL_INSTANCE": "false",
        "DATABASE_ENABLED": "true",
        "DATABASE_PROVIDER": "postgresql",
        "DATABASE_CONNECTION_URI": "postgresql://{{SERVICE_postgres_USER}}:{{SERVICE_postgres_PASSWORD}}@{{SERVICE_postgres_HOST}}:5432/{{APP_DATABASE}}?schema=public",
        "DATABASE_CONNECTION_CLIENT_NAME": "evolution_api",
        "DATABASE_SAVE_DATA_INSTANCE": "true",
        "DATABASE_SAVE_DATA_NEW_MESSAGE": "true",
        "DATABASE_SAVE_MESSAGE_UPDATE": "true",
        "DATABASE_SAVE_DATA_CONTACTS": "true",
        "DATABASE_SAVE_DATA_CHATS": "true",
        "DATABASE_SAVE_DATA_LABELS": "true",
        "DATABASE_SAVE_DATA_HISTORIC": "true",
        "CACHE_REDIS_ENABLED": "true",
        "CACHE_REDIS_URI": "redis://{{SERVICE_redis_HOST}}:6379/0",
        "CACHE_REDIS_PREFIX_KEY": "evolution",
        "CACHE_LOCAL_ENABLED": "false",
        "AUTHENTICATION_TYPE": "apikey",
        "AUTHENTICATION_API_KEY": "{{GENERATE_SECRET_32}}",
        "AUTHENTICATION_EXPOSE_IN_FETCH_INSTANCES": "true",
        "CHATWOOT_ENABLED": "true",
        "CHATWOOT_MESSAGE_READ": "true",
        "CHATWOOT_MESSAGE_DELETE": "true",
        "CHATWOOT_BOT_CONTACT": "true",
        "OPENAI_ENABLED": "true",
        "DIFY_ENABLED": "true",
        "N8N_ENABLED": "true",
        "TYPEBOT_ENABLED": "true"
      },
      "volumes": [
        "{{APP_NAME}}_instances:/evolution/instances",
        "{{APP_NAME}}_store:/evolution/store"
      ],
      "user_env": [
        {
          "key": "CHATWOOT_ENABLED",
          "prompt": "Habilitar integração com Chatwoot? (true/false)",
          "default": "false"
        },
        {
          "key": "CHATWOOT_ACCOUNT_ID",
          "prompt": "ID da conta no Chatwoot (deixe vazio se não usar Chatwoot)",
          "default": ""
        },
        {
          "key": "CHATWOOT_TOKEN",
          "prompt": "Token de acesso do Chatwoot (deixe vazio se não usar Chatwoot)",
          "default": ""
        },
        {
          "key": "CHATWOOT_URL",
          "prompt": "URL do Chatwoot (ex: https://chatwoot.seudominio.com)",
          "default": ""
        },
        {
          "key": "CHATWOOT_SIGN_MSG",
          "prompt": "Assinar mensagens com nome do agente? (true/false)",
          "default": "false"
        },
        {
          "key": "CHATWOOT_REOPEN_CONVERSATION",
          "prompt": "Reabrir conversa ao receber nova mensagem? (true/false)",
          "default": "true"
        },
        {
          "key": "CHATWOOT_CONVERSATION_PENDING",
          "prompt": "Marcar conversa como pendente ao abrir? (true/false)",
          "default": "false"
        }
      ]
    },
    "uptime-kuma": {
      "name": "Uptime Kuma",
      "description": "Monitoramento de uptime - Monitore seus serviços e receba alertas",
      "image": "louislam/uptime-kuma:1",
      "port": 3001,
      "dependencies": [],
      "env": {},
      "volumes": [
        "{{APP_NAME}}_data:/app/data"
      ],
      "user_env": []
    },
    "minio": {
      "name": "MinIO",
      "description": "Object Storage S3-compatible - Armazene arquivos como na AWS S3",
      "image": "minio/minio:latest",
      "port": 9000,
      "console_port": 9001,
      "dependencies": [],
      "command": "server /data --console-address ':9001'",
      "env": {
        "MINIO_ROOT_USER": "{{GENERATE_SECRET_16}}",
        "MINIO_ROOT_PASSWORD": "{{GENERATE_SECRET_32}}",
        "MINIO_BROWSER_REDIRECT_URL": "https://console-{{APP_DOMAIN}}"
      },
      "volumes": [
        "{{APP_NAME}}_data:/data"
      ],
      "user_env": [],
      "traefik": {
        "routes": [
          {
            "subdomain": "{{APP_DOMAIN}}",
            "port": 9000
          },
          {
            "subdomain": "console-{{APP_DOMAIN}}",
            "port": 9001
          }
        ]
      }
    },
    "portainer": {
      "name": "Portainer",
      "description": "Docker Management UI - Gerencie containers via interface web",
      "image": "portainer/portainer-ce:latest",
      "port": 9000,
      "dependencies": [],
      "env": {},
      "volumes": [
        "{{APP_NAME}}_data:/data",
        "/var/run/docker.sock:/var/run/docker.sock"
      ],
      "user_env": []
    },
    "nocodb": {
      "name": "NocoDB",
      "description": "Airtable Open Source - Transforme databases em planilhas",
      "image": "nocodb/nocodb:latest",
      "port": 8080,
      "dependencies": [
        "postgres"
      ],
      "env": {
        "NC_DB": "pg://{{SERVICE_postgres_HOST}}:5432?u={{SERVICE_postgres_USER}}&p={{SERVICE_postgres_PASSWORD}}&d={{APP_DATABASE}}",
        "NC_PUBLIC_URL": "https://{{APP_DOMAIN}}"
      },
      "volumes": [
        "{{APP_NAME}}_data:/usr/app/data"
      ],
      "user_env": []
    },
    "ghost": {
      "name": "Ghost",
      "description": "Blog/CMS Platform - Publique conteúdo profissionalmente",
      "image": "ghost:5-alpine",
      "port": 2368,
      "dependencies": [],
      "env": {
        "url": "https://{{APP_DOMAIN}}",
        "NODE_ENV": "production"
      },
      "volumes": [
        "{{APP_NAME}}_data:/var/lib/ghost/content"
      ],
      "user_env": []
    },
    "gitea": {
      "name": "Gitea",
      "description": "Git Server - Hospede seus repositórios Git",
      "image": "gitea/gitea:latest",
      "port": 3000,
      "dependencies": [
        "postgres"
      ],
      "env": {
        "GITEA__database__DB_TYPE": "postgres",
        "GITEA__database__HOST": "{{SERVICE_postgres_HOST}}:5432",
        "GITEA__database__NAME": "{{APP_DATABASE}}",
        "GITEA__database__USER": "{{SERVICE_postgres_USER}}",
        "GITEA__database__PASSWD": "{{SERVICE_postgres_PASSWORD}}",
        "GITEA__server__ROOT_URL": "https://{{APP_DOMAIN}}",
        "GITEA__server__DOMAIN": "{{APP_DOMAIN}}"
      },
      "volumes": [
        "{{APP_NAME}}_data:/data"
      ],
      "user_env": []
    },
    "plausible": {
      "name": "Plausible Analytics",
      "description": "Privacy-friendly Analytics - Alternativa ao Google Analytics",
      "image": "plausible/analytics:latest",
      "port": 8000,
      "dependencies": [
        "postgres"
      ],
      "env": {
        "BASE_URL": "https://{{APP_DOMAIN}}",
        "SECRET_KEY_BASE": "{{GENERATE_SECRET_64}}",
        "DATABASE_URL": "postgres://{{SERVICE_postgres_USER}}:{{SERVICE_postgres_PASSWORD}}@{{SERVICE_postgres_HOST}}:5432/{{APP_DATABASE}}"
      },
      "volumes": [
        "{{APP_NAME}}_data:/var/lib/plausible"
      ],
      "user_env": []
    },
    "metabase": {
      "name": "Metabase",
      "description": "Business Intelligence - Crie dashboards e relatórios",
      "image": "metabase/metabase:latest",
      "port": 3000,
      "dependencies": [
        "postgres"
      ],
      "env": {
        "MB_DB_TYPE": "postgres",
        "MB_DB_DBNAME": "{{APP_DATABASE}}",
        "MB_DB_PORT": "5432",
        "MB_DB_USER": "{{SERVICE_postgres_USER}}",
        "MB_DB_PASS": "{{SERVICE_postgres_PASSWORD}}",
        "MB_DB_HOST": "{{SERVICE_postgres_HOST}}"
      },
      "volumes": [],
      "user_env": []
    },
    "directus": {
      "name": "Directus",
      "description": "Headless CMS - Backend para apps e sites",
      "image": "directus/directus:latest",
      "port": 8055,
      "dependencies": [
        "postgres",
        "redis"
      ],
      "env": {
        "KEY": "{{GENERATE_SECRET_32}}",
        "SECRET": "{{GENERATE_SECRET_32}}",
        "DB_CLIENT": "pg",
        "DB_HOST": "{{SERVICE_postgres_HOST}}",
        "DB_PORT": "5432",
        "DB_DATABASE": "{{APP_DATABASE}}",
        "DB_USER": "{{SERVICE_postgres_USER}}",
        "DB_PASSWORD": "{{SERVICE_postgres_PASSWORD}}",
        "CACHE_ENABLED": "true",
        "CACHE_STORE": "redis",
        "REDIS_HOST": "{{SERVICE_redis_HOST}}",
        "ADMIN_EMAIL": "admin@example.com",
        "ADMIN_PASSWORD": "{{GENERATE_SECRET_16}}",
        "PUBLIC_URL": "https://{{APP_DOMAIN}}"
      },
      "volumes": [
        "{{APP_NAME}}_uploads:/directus/uploads"
      ],
      "user_env": [
        {
          "key": "ADMIN_EMAIL",
          "prompt": "Email do admin",
          "default": "admin@example.com"
        }
      ]
    },
    "supabase": {
      "name": "Supabase",
      "description": "Open Source Firebase Alternative - Database, Auth, Realtime, Storage & Edge Functions",
      "dependencies": [],
      "shared_env": {
        "POSTGRES_PASSWORD": "{{GENERATE_SECRET_32}}",
        "JWT_SECRET": "{{GENERATE_SECRET_64}}",
        "ANON_KEY": "{{GENERATE_SECRET_64}}",
        "SERVICE_ROLE_KEY": "{{GENERATE_SECRET_64}}",
        "DASHBOARD_USERNAME": "admin",
        "DASHBOARD_PASSWORD": "{{GENERATE_SECRET_16}}",
        "API_EXTERNAL_URL": "https://api-{{APP_DOMAIN}}",
        "SUPABASE_PUBLIC_URL": "https://{{APP_DOMAIN}}",
        "STUDIO_DEFAULT_ORGANIZATION": "Hostfy",
        "STUDIO_DEFAULT_PROJECT": "Default Project"
      },
      "containers": [
        {
          "name": "db",
          "image": "supabase/postgres:15.1.0.147",
          "command": "postgres -c config_file=/etc/postgresql/postgresql.conf",
          "env": {
            "POSTGRES_PASSWORD": "{{POSTGRES_PASSWORD}}",
            "POSTGRES_DB": "postgres"
          },
          "volumes": [
            "{{APP_NAME}}_db:/var/lib/postgresql/data"
          ],
          "healthcheck": {
            "test": [
              "CMD",
              "pg_isready",
              "-U",
              "postgres"
            ],
            "interval": "10s",
            "retries": 5
          }
        },
        {
          "name": "studio",
          "image": "supabase/studio:20240101-cecd26d",
          "port": 3000,
          "is_main": true,
          "env": {
            "STUDIO_PG_META_URL": "http://meta:8080",
            "POSTGRES_PASSWORD": "{{POSTGRES_PASSWORD}}",
            "SUPABASE_URL": "http://kong:8000",
            "SUPABASE_PUBLIC_URL": "{{SUPABASE_PUBLIC_URL}}",
            "SUPABASE_ANON_KEY": "{{ANON_KEY}}",
            "SUPABASE_SERVICE_KEY": "{{SERVICE_ROLE_KEY}}",
            "LOG_LEVEL": "info"
          }
        },
        {
          "name": "kong",
          "image": "kong:2.8.1",
          "port": 8000,
          "command": "sh -c \"echo '_format_version: \\\"2.1\\\"\\nservices:\\n- name: auth\\n  url: http://auth:9999\\n  routes:\\n  - name: auth\\n    paths:\\n    - /auth/v1\\n    strip_path: false\\n- name: rest\\n  url: http://rest:3000\\n  routes:\\n  - name: rest\\n    paths:\\n    - /rest/v1\\n    strip_path: true\\n- name: realtime\\n  url: http://realtime:4000\\n  routes:\\n  - name: realtime\\n    paths:\\n    - /realtime/v1\\n    strip_path: false\\n- name: storage\\n  url: http://storage:5000\\n  routes:\\n  - name: storage\\n    paths:\\n    - /storage/v1\\n    strip_path: false\\n- name: meta\\n  url: http://meta:8080\\n  routes:\\n  - name: meta\\n    paths:\\n    - /pg\\n    strip_path: false' > /var/lib/kong/kong.yml && /docker-entrypoint.sh kong docker-start\"",
          "env": {
            "KONG_DATABASE": "off",
            "KONG_DECLARATIVE_CONFIG": "/var/lib/kong/kong.yml",
            "KONG_DNS_ORDER": "LAST,A,CNAME",
            "KONG_PLUGINS": "request-transformer,cors,key-auth,acl"
          },
          "volumes": [
            "{{APP_NAME}}_kong:/var/lib/kong"
          ],
          "traefik": {
            "routes": [
              {
                "subdomain": "api-{{APP_DOMAIN}}",
                "port": 8000
              }
            ]
          }
        },
        {
          "name": "auth",
          "image": "supabase/gotrue:v2.132.3",
          "env": {
            "GOTRUE_API_HOST": "0.0.0.0",
            "GOTRUE_API_PORT": "9999",
            "GOTRUE_DB_DRIVER": "postgres",
            "GOTRUE_DB_DATABASE_URL": "postgres://supabase_auth_admin:{{POSTGRES_PASSWORD}}@db:5432/postgres",
            "GOTRUE_SITE_URL": "{{SUPABASE_PUBLIC_URL}}",
            "GOTRUE_JWT_SECRET": "{{JWT_SECRET}}",
            "GOTRUE_JWT_EXP": "3600",
            "GOTRUE_JWT_DEFAULT_GROUP_NAME": "authenticated",
            "GOTRUE_EXTERNAL_EMAIL_ENABLED": "true",
            "GOTRUE_MAILER_AUTOCONFIRM": "true"
          }
        },
        {
          "name": "rest",
          "image": "postgrest/postgrest:v11.2.0",
          "env": {
            "PGRST_DB_URI": "postgres://authenticator:{{POSTGRES_PASSWORD}}@db:5432/postgres",
            "PGRST_DB_SCHEMAS": "public,storage,graphql_public",
            "PGRST_DB_ANON_ROLE": "anon",
            "PGRST_JWT_SECRET": "{{JWT_SECRET}}",
            "PGRST_DB_USE_LEGACY_GUCKS": "false"
          }
        },
        {
          "name": "realtime",
          "image": "supabase/realtime:v2.25.22",
          "env": {
            "PORT": "4000",
            "DB_HOST": "db",
            "DB_PORT": "5432",
            "DB_USER": "supabase_admin",
            "DB_PASSWORD": "{{POSTGRES_PASSWORD}}",
            "DB_NAME": "postgres",
            "DB_AFTER_CONNECT_QUERY": "SET search_path TO _realtime",
            "DB_ENC_KEY": "supabaserealtime",
            "API_JWT_SECRET": "{{JWT_SECRET}}",
            "FLY_ALLOC_ID": "fly_alloc_id",
            "SECRET_KEY_BASE": "{{GENERATE_SECRET_64}}",
            "ERL_AFLAGS": "-proto_dist inet_tcp",
            "ENABLE_TAILSCALE": "false",
            "DNS_NODES": "''"
          }
        },
        {
          "name": "storage",
          "image": "supabase/storage-api:v0.43.11",
          "env": {
            "ANON_KEY": "{{ANON_KEY}}",
            "SERVICE_KEY": "{{SERVICE_ROLE_KEY}}",
            "POSTGREST_URL": "http://rest:3000",
            "PGRST_JWT_SECRET": "{{JWT_SECRET}}",
            "DATABASE_URL": "postgres://supabase_storage_admin:{{POSTGRES_PASSWORD}}@db:5432/postgres",
            "FILE_STORAGE_BACKEND_PATH": "/var/lib/storage",
            "TENANT_ID": "stub",
            "REGION": "stub",
            "GLOBAL_S3_BUCKET": "stub"
          },
          "volumes": [
            "{{APP_NAME}}_storage:/var/lib/storage"
          ]
        },
        {
          "name": "imgproxy",
          "image": "darthsim/imgproxy:v3.19.2",
          "env": {
            "IMGPROXY_BIND": ":5001",
            "IMGPROXY_LOCAL_FILESYSTEM_ROOT": "/",
            "IMGPROXY_USE_ETAG": "true",
            "IMGPROXY_LOG_LEVEL": "info"
          }
        },
        {
          "name": "meta",
          "image": "supabase/postgres-meta:v0.75.0",
          "env": {
            "PG_META_PORT": "8080",
            "PG_META_DB_HOST": "db",
            "PG_META_DB_PORT": "5432",
            "PG_META_DB_NAME": "postgres",
            "PG_META_DB_USER": "supabase_admin",
            "PG_META_DB_PASSWORD": "{{POSTGRES_PASSWORD}}"
          }
        }
      ],
      "user_env": []
    },
    "dify": {
      "name": "Dify",
      "description": "LLM App Development Platform - Crie apps com IA Generativa",
      "dependencies": [],
      "shared_env": {
        "DB_PASSWORD": "{{GENERATE_SECRET_32}}",
        "REDIS_PASSWORD": "{{GENERATE_SECRET_32}}",
        "SECRET_KEY": "{{GENERATE_SECRET_64}}",
        "WEAVIATE_API_KEY": "{{GENERATE_SECRET_32}}",
        "ADMIN_PASSWORD": "{{GENERATE_SECRET_16}}",
        "APP_URL": "https://{{APP_DOMAIN}}",
        "API_URL": "https://api-{{APP_DOMAIN}}"
      },
      "containers": [
        {
          "name": "api",
          "image": "langgenius/dify-api:0.15.3",
          "env": {
            "MODE": "api",
            "DB_USERNAME": "postgres",
            "DB_PASSWORD": "{{DB_PASSWORD}}",
            "DB_HOST": "db",
            "DB_PORT": "5432",
            "DB_DATABASE": "dify",
            "REDIS_HOST": "redis",
            "REDIS_PORT": "6379",
            "REDIS_PASSWORD": "{{REDIS_PASSWORD}}",
            "SECRET_KEY": "{{SECRET_KEY}}",
            "APP_WEB_URL": "{{APP_URL}}",
            "APP_API_URL": "{{API_URL}}/v1",
            "CONSOLE_API_URL": "{{API_URL}}/console/api",
            "CONSOLE_WEB_URL": "{{APP_URL}}",
            "SERVICE_API_URL": "{{API_URL}}/service-api",
            "FILES_URL": "{{API_URL}}/files",
            "WEAVIATE_ENDPOINT": "http://weaviate:8080",
            "WEAVIATE_API_KEY": "{{WEAVIATE_API_KEY}}",
            "CODE_EXECUTION_API_KEY": "dify-sandbox",
            "CODE_EXECUTION_ENDPOINT": "http://sandbox:8194"
          },
          "volumes": [
            "{{APP_NAME}}_storage:/app/api/storage"
          ],
          "traefik": {
            "routes": [
              {
                "subdomain": "api-{{APP_DOMAIN}}",
                "port": 5001
              }
            ]
          }
        },
        {
          "name": "worker",
          "image": "langgenius/dify-api:0.15.3",
          "env": {
            "MODE": "worker",
            "DB_USERNAME": "postgres",
            "DB_PASSWORD": "{{DB_PASSWORD}}",
            "DB_HOST": "db",
            "DB_PORT": "5432",
            "DB_DATABASE": "dify",
            "REDIS_HOST": "redis",
            "REDIS_PORT": "6379",
            "REDIS_PASSWORD": "{{REDIS_PASSWORD}}",
            "SECRET_KEY": "{{SECRET_KEY}}",
            "WEAVIATE_ENDPOINT": "http://weaviate:8080",
            "WEAVIATE_API_KEY": "{{WEAVIATE_API_KEY}}"
          },
          "volumes": [
            "{{APP_NAME}}_storage:/app/api/storage"
          ]
        },
        {
          "name": "web",
          "image": "langgenius/dify-web:0.15.3",
          "is_main": true,
          "port": 3000,
          "env": {
            "CONSOLE_API_URL": "{{API_URL}}/console/api",
            "APP_API_URL": "{{API_URL}}/v1"
          }
        },
        {
          "name": "db",
          "image": "postgres:15-alpine",
          "env": {
            "POSTGRES_PASSWORD": "{{DB_PASSWORD}}",
            "POSTGRES_DB": "dify",
            "PGDATA": "/var/lib/postgresql/data/pgdata"
          },
          "volumes": [
            "{{APP_NAME}}_db:/var/lib/postgresql/data"
          ]
        },
        {
          "name": "redis",
          "image": "redis:6-alpine",
          "command": "redis-server --requirepass {{REDIS_PASSWORD}}",
          "volumes": [
            "{{APP_NAME}}_redis:/data"
          ]
        },
        {
          "name": "weaviate",
          "image": "semitechnologies/weaviate:1.27.0",
          "env": {
            "AUTHENTICATION_APIKEY_ENABLED": "true",
            "AUTHENTICATION_APIKEY_ALLOWED_KEYS": "{{WEAVIATE_API_KEY}}",
            "AUTHENTICATION_APIKEY_USERS": "dify",
            "PERSISTENCE_DATA_PATH": "/var/lib/weaviate",
            "DEFAULT_VECTORIZER_MODULE": "none"
          },
          "volumes": [
            "{{APP_NAME}}_weaviate:/var/lib/weaviate"
          ]
        },
        {
          "name": "sandbox",
          "image": "langgenius/dify-sandbox:0.2.12",
          "env": {
            "API_KEY": "dify-sandbox",
            "GIN_MODE": "release"
          }
        },
        {
          "name": "ssrf_proxy",
          "image": "ubuntu/squid:latest",
          "env": {
            "HTTP_PORT": "3128"
          }
        }
      ],
      "user_env": []
    }
  }
}