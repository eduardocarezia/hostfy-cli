{
  "version": "1.0",
  "updated_at": "2024-01-15T10:00:00Z",
  "services": {
    "postgres": {
      "image": "postgres:15-alpine",
      "restart": "always",
      "env": {
        "POSTGRES_USER": "hostfy",
        "POSTGRES_PASSWORD": "{{SYSTEM_GENERATE}}",
        "POSTGRES_DB": "hostfy"
      },
      "volumes": [
        "hostfy_postgres_data:/var/lib/postgresql/data"
      ],
      "ports": [
        "5432:5432"
      ],
      "healthcheck": {
        "test": [
          "CMD-SHELL",
          "pg_isready -U hostfy"
        ],
        "interval": "10s",
        "retries": 5
      }
    },
    "redis": {
      "image": "redis:7-alpine",
      "restart": "always",
      "command": "redis-server --appendonly yes",
      "volumes": [
        "hostfy_redis_data:/data"
      ],
      "ports": [
        "6379:6379"
      ],
      "healthcheck": {
        "test": [
          "CMD",
          "redis-cli",
          "ping"
        ],
        "interval": "10s",
        "retries": 5
      }
    }
  },
  "apps": {
    "n8n": {
      "name": "n8n",
      "description": "Workflow Automation Tool - Stack com Editor + Webhook + Worker para alta disponibilidade",
      "dependencies": [
        "postgres",
        "redis"
      ],
      "shared_env": {
        "DB_TYPE": "postgresdb",
        "DB_POSTGRESDB_HOST": "{{SERVICE_postgres_HOST}}",
        "DB_POSTGRESDB_PORT": "5432",
        "DB_POSTGRESDB_DATABASE": "{{APP_DATABASE}}",
        "DB_POSTGRESDB_USER": "{{SERVICE_postgres_USER}}",
        "DB_POSTGRESDB_PASSWORD": "{{SERVICE_postgres_PASSWORD}}",
        "QUEUE_BULL_REDIS_HOST": "{{SERVICE_redis_HOST}}",
        "QUEUE_HEALTH_CHECK_ACTIVE": "true",
        "EXECUTIONS_MODE": "queue",
        "N8N_ENCRYPTION_KEY": "{{GENERATE_SECRET_32}}",
        "N8N_PROTOCOL": "https",
        "N8N_TRUST_PROXY": "true",
        "N8N_PROXY_HOPS": "1",
        "GENERIC_TIMEZONE": "America/Sao_Paulo",
        "N8N_WEBHOOK_DOMAIN": "{{APP_DOMAIN}}"
      },
      "containers": [
        {
          "name": "editor",
          "image": "n8nio/n8n:latest",
          "port": 5678,
          "is_main": true,
          "env": {
            "N8N_HOST": "{{APP_DOMAIN}}",
            "N8N_EDITOR_BASE_URL": "https://{{APP_DOMAIN}}",
            "WEBHOOK_URL": "https://{{N8N_WEBHOOK_DOMAIN}}"
          },
          "volumes": [
            "{{APP_NAME}}_data:/home/node/.n8n"
          ]
        },
        {
          "name": "webhook",
          "image": "n8nio/n8n:latest",
          "port": 5678,
          "command": "webhook",
          "env": {
            "N8N_DISABLE_UI": "true",
            "WEBHOOK_URL": "https://{{N8N_WEBHOOK_DOMAIN}}",
            "BASE_URL": "https://{{N8N_WEBHOOK_DOMAIN}}"
          },
          "volumes": [
            "{{APP_NAME}}_data:/home/node/.n8n"
          ],
          "traefik": {
            "routes": [
              {
                "subdomain": "{{N8N_WEBHOOK_DOMAIN}}",
                "port": 5678
              }
            ]
          }
        },
        {
          "name": "worker",
          "image": "n8nio/n8n:latest",
          "command": "worker",
          "env": {
            "N8N_DISABLE_UI": "true"
          },
          "volumes": [
            "{{APP_NAME}}_data:/home/node/.n8n"
          ]
        }
      ],
      "user_env": []
    },
    "uptime-kuma": {
      "name": "Uptime Kuma",
      "description": "Monitoramento de uptime - Monitore seus serviços e receba alertas",
      "image": "louislam/uptime-kuma:1",
      "port": 3001,
      "dependencies": [],
      "env": {},
      "volumes": [
        "{{APP_NAME}}_data:/app/data"
      ],
      "user_env": []
    },
    "minio": {
      "name": "MinIO",
      "description": "Object Storage S3-compatible - Armazene arquivos como na AWS S3",
      "image": "minio/minio:latest",
      "port": 9000,
      "console_port": 9001,
      "dependencies": [],
      "command": "server /data --console-address ':9001'",
      "env": {
        "MINIO_ROOT_USER": "{{GENERATE_SECRET_16}}",
        "MINIO_ROOT_PASSWORD": "{{GENERATE_SECRET_32}}",
        "MINIO_BROWSER_REDIRECT_URL": "https://console-{{APP_DOMAIN}}"
      },
      "volumes": [
        "{{APP_NAME}}_data:/data"
      ],
      "user_env": [],
      "traefik": {
        "routes": [
          {
            "subdomain": "{{APP_DOMAIN}}",
            "port": 9000
          },
          {
            "subdomain": "console-{{APP_DOMAIN}}",
            "port": 9001
          }
        ]
      }
    },
    "portainer": {
      "name": "Portainer",
      "description": "Docker Management UI - Gerencie containers via interface web",
      "image": "portainer/portainer-ce:latest",
      "port": 9000,
      "dependencies": [],
      "env": {},
      "volumes": [
        "{{APP_NAME}}_data:/data",
        "/var/run/docker.sock:/var/run/docker.sock"
      ],
      "user_env": []
    },
    "nocodb": {
      "name": "NocoDB",
      "description": "Airtable Open Source - Transforme databases em planilhas",
      "image": "nocodb/nocodb:latest",
      "port": 8080,
      "dependencies": [
        "postgres"
      ],
      "env": {
        "NC_DB": "pg://{{SERVICE_postgres_HOST}}:5432?u={{SERVICE_postgres_USER}}&p={{SERVICE_postgres_PASSWORD}}&d={{APP_DATABASE}}",
        "NC_PUBLIC_URL": "https://{{APP_DOMAIN}}"
      },
      "volumes": [
        "{{APP_NAME}}_data:/usr/app/data"
      ],
      "user_env": []
    },
    "ghost": {
      "name": "Ghost",
      "description": "Blog/CMS Platform - Publique conteúdo profissionalmente",
      "image": "ghost:5-alpine",
      "port": 2368,
      "dependencies": [],
      "env": {
        "url": "https://{{APP_DOMAIN}}",
        "NODE_ENV": "production"
      },
      "volumes": [
        "{{APP_NAME}}_data:/var/lib/ghost/content"
      ],
      "user_env": []
    },
    "gitea": {
      "name": "Gitea",
      "description": "Git Server - Hospede seus repositórios Git",
      "image": "gitea/gitea:latest",
      "port": 3000,
      "dependencies": [
        "postgres"
      ],
      "env": {
        "GITEA__database__DB_TYPE": "postgres",
        "GITEA__database__HOST": "{{SERVICE_postgres_HOST}}:5432",
        "GITEA__database__NAME": "{{APP_DATABASE}}",
        "GITEA__database__USER": "{{SERVICE_postgres_USER}}",
        "GITEA__database__PASSWD": "{{SERVICE_postgres_PASSWORD}}",
        "GITEA__server__ROOT_URL": "https://{{APP_DOMAIN}}",
        "GITEA__server__DOMAIN": "{{APP_DOMAIN}}"
      },
      "volumes": [
        "{{APP_NAME}}_data:/data"
      ],
      "user_env": []
    },
    "plausible": {
      "name": "Plausible Analytics",
      "description": "Privacy-friendly Analytics - Alternativa ao Google Analytics",
      "image": "plausible/analytics:latest",
      "port": 8000,
      "dependencies": [
        "postgres"
      ],
      "env": {
        "BASE_URL": "https://{{APP_DOMAIN}}",
        "SECRET_KEY_BASE": "{{GENERATE_SECRET_64}}",
        "DATABASE_URL": "postgres://{{SERVICE_postgres_USER}}:{{SERVICE_postgres_PASSWORD}}@{{SERVICE_postgres_HOST}}:5432/{{APP_DATABASE}}"
      },
      "volumes": [
        "{{APP_NAME}}_data:/var/lib/plausible"
      ],
      "user_env": []
    },
    "metabase": {
      "name": "Metabase",
      "description": "Business Intelligence - Crie dashboards e relatórios",
      "image": "metabase/metabase:latest",
      "port": 3000,
      "dependencies": [
        "postgres"
      ],
      "env": {
        "MB_DB_TYPE": "postgres",
        "MB_DB_DBNAME": "{{APP_DATABASE}}",
        "MB_DB_PORT": "5432",
        "MB_DB_USER": "{{SERVICE_postgres_USER}}",
        "MB_DB_PASS": "{{SERVICE_postgres_PASSWORD}}",
        "MB_DB_HOST": "{{SERVICE_postgres_HOST}}"
      },
      "volumes": [],
      "user_env": []
    },
    "directus": {
      "name": "Directus",
      "description": "Headless CMS - Backend para apps e sites",
      "image": "directus/directus:latest",
      "port": 8055,
      "dependencies": [
        "postgres",
        "redis"
      ],
      "env": {
        "KEY": "{{GENERATE_SECRET_32}}",
        "SECRET": "{{GENERATE_SECRET_32}}",
        "DB_CLIENT": "pg",
        "DB_HOST": "{{SERVICE_postgres_HOST}}",
        "DB_PORT": "5432",
        "DB_DATABASE": "{{APP_DATABASE}}",
        "DB_USER": "{{SERVICE_postgres_USER}}",
        "DB_PASSWORD": "{{SERVICE_postgres_PASSWORD}}",
        "CACHE_ENABLED": "true",
        "CACHE_STORE": "redis",
        "REDIS_HOST": "{{SERVICE_redis_HOST}}",
        "ADMIN_EMAIL": "admin@example.com",
        "ADMIN_PASSWORD": "{{GENERATE_SECRET_16}}",
        "PUBLIC_URL": "https://{{APP_DOMAIN}}"
      },
      "volumes": [
        "{{APP_NAME}}_uploads:/directus/uploads"
      ],
      "user_env": [
        {
          "key": "ADMIN_EMAIL",
          "prompt": "Email do admin",
          "default": "admin@example.com"
        }
      ]
    },
    "chatwoot": {
      "name": "Chatwoot",
      "description": "Customer Engagement Platform - Atendimento ao cliente omnichannel",
      "image": "chatwoot/chatwoot:latest",
      "port": 3000,
      "dependencies": [
        "postgres",
        "redis"
      ],
      "env": {
        "RAILS_ENV": "production",
        "NODE_ENV": "production",
        "INSTALLATION_ENV": "docker",
        "SECRET_KEY_BASE": "{{GENERATE_SECRET_64}}",
        "FRONTEND_URL": "https://{{APP_DOMAIN}}",
        "POSTGRES_HOST": "{{SERVICE_postgres_HOST}}",
        "POSTGRES_PORT": "5432",
        "POSTGRES_DATABASE": "{{APP_DATABASE}}",
        "POSTGRES_USERNAME": "{{SERVICE_postgres_USER}}",
        "POSTGRES_PASSWORD": "{{SERVICE_postgres_PASSWORD}}",
        "REDIS_URL": "redis://{{SERVICE_redis_HOST}}:6379",
        "RAILS_LOG_TO_STDOUT": "true",
        "DEFAULT_LOCALE": "pt_BR",
        "ENABLE_ACCOUNT_SIGNUP": "false"
      },
      "volumes": [
        "{{APP_NAME}}_storage:/app/storage"
      ],
      "user_env": [
        {
          "key": "MAILER_SENDER_EMAIL",
          "prompt": "Email do remetente (para notificações)",
          "default": "noreply@{{APP_DOMAIN}}"
        }
      ],
      "command": "bundle exec rails s -p 3000 -b 0.0.0.0"
    },
    "evolution-api": {
      "name": "Evolution API",
      "description": "WhatsApp API - Integração WhatsApp para automações e chatbots",
      "image": "evoapicloud/evolution-api:latest",
      "port": 8080,
      "dependencies": [
        "postgres",
        "redis"
      ],
      "env": {
        "SERVER_URL": "https://{{APP_DOMAIN}}",
        "SERVER_TYPE": "http",
        "SERVER_PORT": "8080",
        "CORS_ORIGIN": "*",
        "CORS_METHODS": "GET,POST,PUT,DELETE",
        "CORS_CREDENTIALS": "true",
        "LOG_LEVEL": "ERROR,WARN,DEBUG,INFO,LOG,VERBOSE,DARK,WEBHOOKS",
        "DEL_INSTANCE": "false",
        "DATABASE_ENABLED": "true",
        "DATABASE_PROVIDER": "postgresql",
        "DATABASE_CONNECTION_URI": "postgresql://{{SERVICE_postgres_USER}}:{{SERVICE_postgres_PASSWORD}}@{{SERVICE_postgres_HOST}}:5432/{{APP_DATABASE}}?schema=public",
        "DATABASE_CONNECTION_CLIENT_NAME": "evolution_api",
        "DATABASE_SAVE_DATA_INSTANCE": "true",
        "DATABASE_SAVE_DATA_NEW_MESSAGE": "true",
        "DATABASE_SAVE_MESSAGE_UPDATE": "true",
        "DATABASE_SAVE_DATA_CONTACTS": "true",
        "DATABASE_SAVE_DATA_CHATS": "true",
        "DATABASE_SAVE_DATA_LABELS": "true",
        "DATABASE_SAVE_DATA_HISTORIC": "true",
        "CACHE_REDIS_ENABLED": "true",
        "CACHE_REDIS_URI": "redis://{{SERVICE_redis_HOST}}:6379/0",
        "CACHE_REDIS_PREFIX_KEY": "evolution",
        "CACHE_LOCAL_ENABLED": "false",
        "AUTHENTICATION_TYPE": "apikey",
        "AUTHENTICATION_API_KEY": "{{GENERATE_SECRET_32}}",
        "AUTHENTICATION_EXPOSE_IN_FETCH_INSTANCES": "true"
      },
      "volumes": [
        "{{APP_NAME}}_instances:/evolution/instances",
        "{{APP_NAME}}_store:/evolution/store"
      ],
      "user_env": []
    }
  }
}